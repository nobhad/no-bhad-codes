import{B as d}from"./chunk-DFiJEDgY.js";import{a as o}from"./chunk-Dmuk_T3B.js";import{S as m}from"./chunk-DYKrrkk1.js";import{g as s}from"./chunk-DjKJqAo0.js";import"./index-DIemqqyN.js";import"./chunk-C20AiJlz.js";class E extends d{constructor(t={}){super("NavigationModule",t),this.nav=null,this.overlay=null,this.menuToggles=null,this.menuLinks=null,this.bgPanels=null,this.menuButtonTexts=null,this.mainTimeline=null,this.routerService=null,this.dataService=null,this.submenuModule=null,this.options=t,this.routerService=t.routerService||null,this.dataService=t.dataService||null}async onInit(){await this.cacheElements(),this.setupEventListeners(),this.setupStateSubscriptions(),this.setupAnimations(),this.setupRoutes(),await this.loadNavigationData(),this.submenuModule=new m({debug:this.options.debug||!1}),await this.submenuModule.init()}async cacheElements(){this.nav=this.getElement("nav","[data-nav]",!0),this.overlay=this.getElement("overlay",".overlay",!1),this.menuToggles=this.getElements("menuToggles","[data-menu-toggle]",!0),this.menuLinks=this.getElements("menuLinks",".menu-link",!0),this.bgPanels=this.getElements("bgPanels",".bg-panel",!0),this.menuButtonTexts=this.getElements("menuButtonTexts",".menu-button-text p",!1)}setupEventListeners(){this.menuToggles&&this.menuToggles.forEach(t=>{this.addEventListener(t,"click",()=>{this.toggleMenu()})}),this.menuLinks&&this.menuLinks.forEach(t=>{this.addEventListener(t,"click",e=>{if(t.hasAttribute("data-submenu-toggle"))return;if(t.classList.contains("disabled")){e.preventDefault();return}t.getAttribute("href")&&this.closeMenu()})}),this.overlay&&this.addEventListener(this.overlay,"click",()=>{this.closeMenu()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&o.getState().navOpen&&this.closeMenu()})}setupStateSubscriptions(){this.unsubscribeNav=o.subscribeToProperty("navOpen",t=>{t?this.openMenuAnimation():this.closeMenuAnimation()})}setupAnimations(){this.nav&&(this.mainTimeline=s.timeline({paused:!0}),s.set(this.nav,{display:"none"}),this.log("Animations initialized"))}toggleMenu(){const t=o.getState().navOpen;o.setState({navOpen:!t})}openMenuAnimation(){if(!this.nav||!this.mainTimeline)return;this.log("Opening menu"),this.nav.setAttribute("data-nav","open"),document.body.style.overflow="hidden",s.timeline().set(this.nav,{display:"block"}).set(document.querySelector(".menu"),{xPercent:0},"<").fromTo(this.menuButtonTexts,{yPercent:0},{yPercent:-100,stagger:.15,duration:.5}).fromTo(document.querySelector(".menu-button-icon"),{rotation:0},{rotation:45,duration:.5},"<").fromTo(this.overlay,{autoAlpha:0},{autoAlpha:1,duration:.5},"<").fromTo(this.bgPanels,{xPercent:101},{xPercent:0,stagger:.08,duration:.4},"<").fromTo(this.menuLinks,{yPercent:140,autoAlpha:0},{yPercent:0,autoAlpha:1,stagger:.04,duration:.5},"<+=0.25")}closeMenuAnimation(){if(!this.nav)return;this.log("Closing menu"),s.timeline({onComplete:()=>{this.nav&&(this.nav.setAttribute("data-nav","closed"),document.body.style.overflow="")}}).to(this.overlay,{autoAlpha:0,duration:.3}).to(document.querySelector(".menu"),{xPercent:120,duration:.3},"<").to(this.menuButtonTexts,{yPercent:0,duration:.3},"<").to(document.querySelector(".menu-button-icon"),{rotation:0,duration:.3},"<").set(this.nav,{display:"none"})}setupRoutes(){if(!this.routerService)return;const t=[{path:"/",section:"intro",title:"No Bhad Codes - Portfolio",onEnter:()=>this.onSectionEnter("home")},{path:"/projects",section:"portfolio",title:"Portfolio - No Bhad Codes",onEnter:()=>this.onSectionEnter("portfolio")},{path:"/client",section:"client",title:"Client Portal - No Bhad Codes",onEnter:()=>this.onSectionEnter("client")},{path:"#about",section:"about",title:"About - No Bhad Codes",onEnter:()=>this.onSectionEnter("about")},{path:"#contact",section:"contact",title:"Contact - No Bhad Codes",onEnter:()=>this.onSectionEnter("contact")}];this.routerService.addRoutes(t),this.log("Routes registered with router service")}async loadNavigationData(){try{let t=[];if(this.dataService&&(t=this.dataService.getNavigation()?.main||[]),t.length===0&&typeof window<"u"){const e=window.NAVIGATION_DATA;e?.menuItems&&(t=e.menuItems)}if(t.length===0){const e=document.querySelector("[data-navigation]");if(e){const i=e.getAttribute("data-navigation");if(i)try{t=JSON.parse(i).menuItems||[]}catch{console.warn("Failed to parse navigation data from DOM")}}}t.length===0&&(t=[{id:"home",text:"home",href:"/",eyebrow:"00"},{id:"about",text:"about",href:"#about",eyebrow:"01"},{id:"contact",text:"contact",href:"#contact",eyebrow:"02"},{id:"client",text:"client portal",href:"/client-portal/",eyebrow:"04"}]),this.updateNavigationDOM(t),this.detectCurrentPage()}catch(t){console.error("Error loading navigation data:",t),this.detectCurrentPage()}}updateNavigationDOM(t){this.menuLinks&&t.forEach((e,i)=>{const n=this.menuLinks?.[i];if(n){const a=n.querySelector(".menu-link-heading"),l=n.querySelector(".eyebrow"),c=e.text||e.title||"",h=e.href||e.path||"#";a&&(a.textContent=c,a.setAttribute("data-text",c)),l&&(l.textContent=e.eyebrow||""),n.setAttribute("href",h),e.disabled?(n.classList.add("disabled"),n.setAttribute("href","#")):n.classList.remove("disabled");const r=n.querySelector(".coming-soon-banner");if(e.comingSoon){if(!r){const u=document.createElement("div");u.className="coming-soon-banner",u.textContent="Coming Soon",n.appendChild(u)}}else r&&r.remove()}})}onSectionEnter(t){this.log(`Entered section: ${t}`),this.dispatchEvent("section-entered",{sectionName:t})}closeMenu(){this.submenuModule&&this.submenuModule.closeAllSubmenus(),o.setState({navOpen:!1})}detectCurrentPage(){const t=window.location.pathname;this.menuLinks&&this.menuLinks.forEach(e=>{const i=e.getAttribute("href"),n=e;n.classList.remove("active"),(i===t||t==="/"&&i?.startsWith("/#")||t==="/projects"&&i==="/projects"||t==="/client"&&i==="/client")&&n.classList.add("active")})}navigateToSection(t){this.routerService&&this.routerService.navigate(`#${t}`)}getNavigationState(){return{isOpen:o.getState().navOpen,currentRoute:this.routerService?.getCurrentRoute(),hasRouter:!!this.routerService}}onDestroy(){this.unsubscribeNav&&this.unsubscribeNav(),this.mainTimeline&&this.mainTimeline.kill(),this.submenuModule&&(this.submenuModule.destroy(),this.submenuModule=null),document.body.style.overflow=""}}export{E as NavigationModule};
